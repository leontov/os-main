# Kolibri Developer Guide / Руководство разработчика / 开发者指南

**Copyright (c) 2025 Кочуров Владислав Евгеньевич**

---

## 1. Purpose / Назначение / 目的

Документ описывает требования к разработке Kolibri: сборка, тестирование, линтинг, код-стайл и процесс внесения изменений.

---

## 2. Build Workflow / Процесс сборки / 构建流程

### Русский
1. Установите зависимости компилятора C11 и `cmake` (при необходимости).
2. Выполните `make` для генерации бинарников в `build/`.
3. Для чистой сборки используйте `make clean`.
4. Скрипт `./kolibri.sh up` выполняет последовательность: сборка, тесты, запуск локального роя.

### English
Run `make`, `make test`, and `./kolibri.sh up` after source changes. Use `cmake --build build` for IDE-generated projects.

### 中文
修改源码后依次执行 `make`、`make test` 与 `./kolibri.sh up`。若使用 IDE，可通过 `cmake --build build` 构建。

---

## 3. Testing Matrix / Матрица тестирования / 测试矩阵

| Layer | Command | Notes |
|-------|---------|-------|
| Unit tests | `make test` | Покрывают decimal/genome/formula/net. |
| Property tests | встроены в `tests/test_formula.c` | Используют случайные входы с фиксированным seed. |
| Static analysis | `clang-tidy backend/src/*.c apps/kolibri_node.c -- -Ibackend/include` | Выполняется при изменении C-кода. |
| Integration | `./kolibri.sh up` | Стартует два узла и проверяет обмен формулами. |

*Документационные изменения не требуют запуска тестов, однако в коммит-сообщении нужно явно указывать причину пропуска.*

---

## 4. Coding Standards / Стандарты кодирования / 编码规范

- Соблюдайте C11, избегайте нестандартных расширений.
- Новые заголовочные файлы размещайте в `backend/include/kolibri/` с защитой `#ifndef`/`#define`.
- Логирование: используйте существующие макросы `printf`/`fprintf` с префиксами `[INFO]`, `[ERROR]`.
- Детеминизм: все генераторы случайных чисел принимают seed.
- Добавляйте авторскую строку в новые файлы.

---

## 5. Git & Commits / Git и коммиты / Git 提交

- Работайте в ветке `main` без дополнительных веток.
- Используйте Conventional Commits: `feat:`, `fix:`, `docs:`, `chore:`.
- Перед коммитом убедитесь, что `git status` чист и тесты успешны.
- При изменении CLI/протоколов обновляйте `README.md`, `docs/`, и при необходимости `docs/api_spec.yaml`.

---

## 6. Documentation Policy / Политика документации / 文档策略

- Все новые возможности сопровождаются многоязычным описанием (RU/EN/ZH) в соответствующих файлах.
- Научные результаты отражаются в `docs/kolibri_integrated_prototype.md`.
- Эта папка (`docs/`) является единственным источником истины для проектной документации.

---

## 7. Release Checklist / Чек-лист релиза / 发布清单

1. `make`, `make test`, `./kolibri.sh up` без ошибок.
2. `clang-tidy` для затронутых исходников.
3. Обновлённые документы и ссылки в `README.md`.
4. Проверка отсутствия секретов и бинарных артефактов в репозитории.
5. Создание PR с описанием изменений и ссылкой на задачу.

